{"backend_state":"running","kernel":"python3","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":79450112},"metadata":{"colab":{"name":"Unit 10 - MTA Data Analysis Student Version.ipynb","provenance":[],"version":"0.3.2"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.6.7"}},"trust":false,"type":"settings"}
{"cell_type":"code","exec_count":0,"id":"0a13f9","input":"#insert 7","metadata":{"colab":{},"colab_type":"code","id":"S1jYB-EUPhUy"},"pos":13,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"0b3f66","input":"#insert 22","metadata":{"colab":{},"colab_type":"code","id":"BaH-GS-5PhVt"},"pos":44,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"0e8e4a","input":"def garbageEliminator(tup):\n    '''removes nonsensical isolated points'''\n    n = len(bigDict[tup[0]][tup[1]])\n    toDel = []\n    for i in range(1,n-1):\n        if((bigDict[tup[0]][tup[1]][i-1][1]>bigDict[tup[0]][tup[1]][i+1][1])):\n            continue\n        if((bigDict[tup[0]][tup[1]][i-1][1]<=bigDict[tup[0]][tup[1]][i][1]) and (bigDict[tup[0]][tup[1]][i][1]<=bigDict[tup[0]][tup[1]][i+1][1])):\n            continue\n        toDel.append(bigDict[tup[0]][tup[1]][i])\n    #Deletion Process\n    if(len(toDel)==0):\n        return 0\n    for k in toDel:\n        bigDict[tup[0]][tup[1]].remove(k)\n    return 1\n\n\n#Driver\ncnt = 0\nhealList = []\nfor k in trouble:\n    if(garbageEliminator(k)):\n        healList.append(k)\nprint(\"Garbage Removed:\",len(healList))\nfor k in healList:\n    inspection(k[0], k[1])","metadata":{"colab":{},"colab_type":"code","id":"Yosg1ex6PhVa","outputId":"fe3ac72a-5246-46ed-cbf5-ce7076af2185"},"output":{"0":{"name":"stdout","output_type":"stream","text":"Garbage Removed: 3\n"},"1":{"data":{"image/png":"ff1d0a9474209b9c586ffb5779b09a7e8ea0ca3e"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"2":{"data":{"image/png":"4c1d319355f7253217a779782f07e14abbe688e7"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"3":{"data":{"image/png":"eed46ea84ee174d5b3f5d8040d1297855f6e6116"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}},"pos":34,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"25a1a4","input":"#insert 5","metadata":{"colab":{},"colab_type":"code","id":"2NYLAovdPhUq"},"pos":9,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"2b77f1","input":"#insert 4","metadata":{"colab":{},"colab_type":"code","id":"Q8wuU_CRPhUn"},"pos":7,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"3a8da5","input":"#insert 9","metadata":{"colab":{},"colab_type":"code","id":"gV_u3A4lPhU6"},"pos":17,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"3ccd1d","input":"def isMonotoneDecrease(tup):\n    '''Input: Tuple of (Station,SCP). \n    Output: True if this SCP has monotone property, but decreasing, False otherwise.'''\n    n = len(bigDict[tup[0]][tup[1]])\n    for i in range(n-1):\n        if(bigDict[tup[0]][tup[1]][i+1][1]>bigDict[tup[0]][tup[1]][i][1]):\n            return False\n    return True\n\ndef fixMonotoneDecrease(tup):\n    '''reflects the data to fix it'''\n    n = len(bigDict[tup[0]][tup[1]])\n    for i in range(n):\n        bigDict[tup[0]][tup[1]][i] = (bigDict[tup[0]][tup[1]][i][0],(-1)*bigDict[tup[0]][tup[1]][i][1])\n    \n\nmonotoneDecreaseList = []\nfor k in trouble:\n    if(isMonotoneDecrease(k)):\n        monotoneDecreaseList.append(k)\nprint(\"Total Monotone Decrease:\",len(monotoneDecreaseList))\nfor k in monotoneDecreaseList:\n    fixMonotoneDecrease(k)\nprint(\"Problem Fixed!\")\n\nfor k in trouble:\n    if(isMonotoneDecrease(k)):\n        monotoneDecreaseList.append(k)\nprint(\"Total Monotone Decrease:\",len(monotoneDecreaseList))\nfor k in monotoneDecreaseList:\n    inspection(k[0], k[1])","metadata":{"colab":{},"colab_type":"code","id":"RZrRM7QZPhVT","outputId":"6cec83ae-f11c-49a8-d83f-1eebc3812690"},"output":{"0":{"name":"stdout","output_type":"stream","text":"Total Monotone Decrease: 32\nProblem Fixed!\nTotal Monotone Decrease: 32\n"},"1":{"data":{"image/png":"014fc3c606c5758f37053644c19a479324c1026e"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"10":{"data":{"image/png":"e29b850094bc86f08fd52978e2a08bd3baf3106e"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"11":{"data":{"image/png":"4664c048a6731fadd8bb8410eeabf996777c9caf"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"12":{"data":{"image/png":"5d21b0160ef9577f890d79f6dcbdc28c2ac5d113"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"13":{"data":{"image/png":"2e8bcacd51bcbe73b07b6432a223f58c34dc4a4a"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"14":{"data":{"image/png":"147be9dd0debb16abf163499cba3aa6eb6e39b8a"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"15":{"data":{"image/png":"36f926f387dfabef41c026d66ec0f5e6d6795fbe"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"16":{"data":{"image/png":"26d975d46c2f6652886607d95b40cf6ee169cd66"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"17":{"data":{"image/png":"16fa9b887323e831e31dac732f5e9d5147e1e532"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"18":{"data":{"image/png":"3536c27a93c225fc68fbffb91764529d71d023fa"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"19":{"data":{"image/png":"2042e81aeca8b0d858f590f69b96e74c364054b2"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"2":{"data":{"image/png":"2b2b0fc0e61dd52b06502fdbb7ab95af35c4a000"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"20":{"data":{"image/png":"1317ebc0ad2314ba266214cac3be2f2deea0a821"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"21":{"data":{"image/png":"f92faa7bba3a02c275b3e695f86ff8b9af435a56"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"22":{"data":{"image/png":"0cc01dc2f0711a44400f0837e17c41c01f41d251"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"23":{"data":{"image/png":"7909c8af22823532ed4db06c586480d9ecc5b3cf"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"24":{"data":{"image/png":"2b5c2083af88f471c18aa441efb497749513d3cb"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"25":{"data":{"image/png":"b9a6bad6c220baa7254102638c80cd8c89e4c4f8"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"26":{"data":{"image/png":"a7d3b9504d3d2895728645a97a0ccbafd1fd9b23"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"27":{"data":{"image/png":"8489694804de9458cb4bc3483c230a6ef33eaa67"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"28":{"data":{"image/png":"394f5252beb491d293c7473efb9c7d7d09f9af50"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"29":{"data":{"image/png":"9120d217e12794994a3e739b84cb14283a81b8e1"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"3":{"data":{"image/png":"4520396afad808e810498a104bb0b00eb364748c"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"30":{"data":{"image/png":"fab8ba55e7074cb70eec2fc00c755028be9c0619"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"31":{"data":{"image/png":"afe3bc8cb9c4d35c5b2d354445ea370a366e4910"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"32":{"data":{"image/png":"13baa027eb10d102d18ebec5c415124046a93dcc"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"4":{"data":{"image/png":"3fabb874332516ac0ea42e8347fbd122dd3ddc72"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"5":{"data":{"image/png":"62de8125d2ac89ab7d80cb12227383cb77733462"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"6":{"data":{"image/png":"582c89c1a166276450ce2da0f4dd477b60b47837"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"7":{"data":{"image/png":"3036daa7e006bf0f5fe29452bce2a5ce1f696ec8"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"8":{"data":{"image/png":"dc65b4919f598c92b84c370e0f0319df0af53bc9"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"9":{"data":{"image/png":"25cb3ceed8f7677813de8631d0e67fe279f69ccc"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}},"pos":32,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"41006e","input":"#insert 31","metadata":{"colab":{},"colab_type":"code","id":"MIHgElRQPhWE"},"pos":60,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"433e10","input":"#insert 26","metadata":{"colab":{},"colab_type":"code","id":"3Peae4oHPhV5"},"pos":52,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"5048cd","input":"#insert 10","metadata":{"colab":{},"colab_type":"code","id":"F6LMCUSFPhU9"},"pos":19,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"505a08","input":"def dealingWithReset(tup):\n    '''for counters that are reset, we fix the data by shifting it upwards'''\n    sta = tup[0]\n    tsl = tup[1]\n    n = len(bigDict[sta][tsl])\n    #Detecting Part\n    resetPoint = [] # it means (i,i+1) is reset\n    resetSet = []\n    for i in range(1,n-2):\n        if(bigDict[sta][tsl][i][1]<=bigDict[sta][tsl][i+1][1]):\n            continue #We don't need to change this one\n        resetPoint.append(i)\n    #Fixing Part\n    resetSet = set(resetPoint)\n    cumulative = 0\n    for i in range(n-2):\n        if(i not in resetSet):\n            bigDict[sta][tsl][i] = (bigDict[sta][tsl][i][0],bigDict[sta][tsl][i][1]+cumulative)\n            continue\n        #Problem\n        expected = (bigDict[sta][tsl][i][1]-bigDict[sta][tsl][i-1][1])+ (bigDict[sta][tsl][i+2][1]-bigDict[sta][tsl][i+1][1])\n        expected = int(expected/2)\n        shift = (bigDict[sta][tsl][i][1]+expected)-bigDict[sta][tsl][i+1][1]\n        cumulative = shift\n    for i in range(n-2,n):\n        bigDict[sta][tsl][i] = (bigDict[sta][tsl][i][0],bigDict[sta][tsl][i][1]+cumulative)\n    #Done!\n    \n#Test Usage\ninspection(('JFK03', 'R536', 'JFK JAMAICA CT1'), '00-03-00')\ndealingWithReset((('JFK03', 'R536', 'JFK JAMAICA CT1'), '00-03-00'))\nprint(\"Cleaned\")\ninspection(('JFK03', 'R536', 'JFK JAMAICA CT1'), '00-03-00')","metadata":{"colab":{},"colab_type":"code","id":"_Q9Uvl-APhVd","outputId":"e268af6a-263e-48a8-b44e-e883ba227697"},"output":{"0":{"data":{"image/png":"b09c178ab73c7bf13bc7db6083577b96ec5b40a8"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"1":{"name":"stdout","output_type":"stream","text":"Cleaned\n"},"2":{"data":{"image/png":"95d6b353db5f25fe8826a001bbf5d26ad01397ea"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}},"pos":36,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"57719b","input":"#insert 28","metadata":{"colab":{},"colab_type":"code","id":"96J5DK0ePhWA"},"pos":56,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"5c8954","input":"#insert 31","metadata":{"colab":{},"colab_type":"code","id":"JbZfNH0SPhWI"},"pos":62,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"5f2ba8","input":"#insert 23","metadata":{"colab":{},"colab_type":"code","id":"gll6KAACPhVw"},"pos":46,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"5f33b6","input":"#insert 14","metadata":{"colab":{},"colab_type":"code","id":"xp_22cNoPhVJ"},"pos":27,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"61619e","input":"trouble = {}\nfor st,stv in bigDict.items():\n    for scp,lst in stv.items():\n        #Cleaning in Each LIST of turnstile\n        toDel = []\n        n = len(lst)\n        lst.sort()\n        for i in range(1,n-1):\n            if(lst[i-1][1]<=lst[i][1] and lst[i][1]<=lst[i+1][1]): #What we expected Data to be (Non-Decreasing)\n                continue\n                \n            key = (st,scp)\n            trouble[key] = trouble.get(key,0)+1\nprint(\"Trouble List: \",len(trouble.keys()))\nfor k,v in trouble.items():\n    print(k,v)","metadata":{"colab":{},"colab_type":"code","id":"Bk80qJWkPhVl","outputId":"c61990cc-3de6-4bf0-8312-84dab104d40e"},"output":{"0":{"name":"stdout","output_type":"stream","text":"Trouble List:  2\n(('PTH11', 'R545', '14TH STREET'), '00-00-03') 3\n(('R240', 'R047', 'GRD CNTRL-42 ST'), '00-00-01') 1\n"}},"pos":40,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"6be614","input":"#insert 21","metadata":{"colab":{},"colab_type":"code","id":"J-Qbu3zbPhVq"},"pos":42,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"6de407","input":"#insert 11","metadata":{"colab":{},"colab_type":"code","id":"BHlTC7_yPhVA"},"pos":21,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"764817","input":"#insert 8","metadata":{"colab":{},"colab_type":"code","id":"jzIxrOlYPhU3"},"pos":15,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"783d5a","input":"#insert 15","metadata":{"colab":{},"colab_type":"code","id":"dnxCjxB5PhVM"},"pos":29,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"796c88","input":"#insert 24","metadata":{"colab":{},"colab_type":"code","id":"O3WxVxloPhVz"},"pos":48,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"7a1849","input":"#insert 3","metadata":{"colab":{},"colab_type":"code","id":"VPkcWYbdPhUk"},"pos":5,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"98303b","input":"#insert 29","metadata":{"colab":{},"colab_type":"code","id":"q4Q7Uzc8PhWC"},"pos":58,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"a0470f","input":"#insert 6","metadata":{"colab":{},"colab_type":"code","id":"zimRzTJMPhUu"},"pos":11,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"a7a2fb","input":"#insert 32","metadata":{"colab":{},"colab_type":"code","id":"Y2Bu9CROPhWK"},"pos":64,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"be9067","input":"toClean = {}\nfor st,stv in bigDict.items():\n    for scp,lst in stv.items():\n        #Cleaning in Each LIST of turnstile\n        toDel = []\n        n = len(lst)\n        lst.sort()\n        for i in range(1,n-1):\n            if(lst[i-1][1]<=lst[i][1] and lst[i][1]<=lst[i+1][1]): #What we expected Data to be (Non-Decreasing)\n                continue\n\n            key = (st,scp)\n            toClean[key] = trouble.get(key,0)+1\n            \nfor k in toClean.keys():\n    if(isMonotoneDecrease(k)):\n        fixMonotoneDecrease(k)\n    garbageEliminator(k)\n    dealingWithReset(k)\n    inspection(k[0], k[1])","metadata":{"colab":{},"colab_type":"code","id":"PmQDV_w6PhVi","outputId":"164fc903-a25f-424d-9ea4-541062039093"},"output":{"0":{"data":{"image/png":"ac10523348d8272fc7c181cc6ed5c4ad8ffc04d3"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"},"1":{"data":{"image/png":"a2dffa4ab1ccee29568652d72a2d00917e371cbd"},"exec_count":0,"metadata":{"tags":[]},"output_type":"execute_result"}},"pos":38,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"c6c930","input":"#insert 12","metadata":{"colab":{},"colab_type":"code","id":"ZSuarWASPhVC"},"pos":23,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"ca3a62","input":"#insert 25","metadata":{"colab":{},"colab_type":"code","id":"FyVMIPztPhV2"},"pos":50,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"db2991","input":"#insert 2","metadata":{"colab":{},"colab_type":"code","id":"lI12wZTDPhUf"},"pos":3,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"df7378","input":"#insert 33","metadata":{"colab":{},"colab_type":"code","id":"ep_Wnvf0PhWQ"},"pos":66,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"e329e2","input":"#insert 1","metadata":{"colab":{},"colab_type":"code","id":"dC6ij1oWPhUb"},"pos":1,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"fd39d4","input":"#insert 13","metadata":{"colab":{},"colab_type":"code","id":"GzHd5fJbPhVG"},"pos":25,"type":"cell"}
{"cell_type":"code","exec_count":0,"id":"fd90a0","input":"#insert 27","metadata":{"colab":{},"colab_type":"code","id":"tw8fwI_BPhV8"},"pos":54,"type":"cell"}
{"cell_type":"markdown","id":"016a44","input":"20.Which troublesome stations are left?","metadata":{"colab_type":"text","id":"B-eaK9XNPhVk"},"pos":39,"type":"cell"}
{"cell_type":"markdown","id":"028a06","input":"## Data Cleanup\nThere are three types of mistakes: decreasing, garbage values, and turnstile resets.","metadata":{"colab_type":"text","id":"ctWRbA6NPhVR"},"pos":30,"type":"cell"}
{"cell_type":"markdown","id":"0bbf53","input":"13.Create a function called inspection that takes in the (C/A,UNIT,STATION) tuple and SCP value and plots the exit counter data versus time. \n\nFor example, the input of \n```python\ninspection(('A037', 'R170', '14 ST-UNION SQ'), '05-00-00')\n```\nshould produce an upward trending plot.","metadata":{"colab_type":"text","id":"zRotAgYHPhVF"},"pos":24,"type":"cell"}
{"cell_type":"markdown","id":"17deb5","input":"22.The data is now all cleaned, so let's save it so that we don't have to run all of the above code every time. Use the pickle package to save bigDict as an \"MTAdict.pkl\" file.","metadata":{"colab_type":"text","id":"mYiZoVzLPhVs"},"pos":43,"type":"cell"}
{"cell_type":"markdown","id":"1888ec","input":"24.Create a function called turnstileRiders that takes in a single turnstile's date/exit info and a start and endtime (in datetime format) and returns the number of riders through that turnstile within that time period. As an extension, you may want to use a linear approximation in the case of incomplete information. \n\nFor instance, the input \n```python\nt1 = dt.strptime(\"2017-06-12 00:00:00\",\"%Y-%m-%d %H:%M:%S\")\nt2 = dt.strptime(\"2017-06-13 00:00:00\",\"%Y-%m-%d %H:%M:%S\")\nturnstileRiders(bigDict[('R204', 'R043', 'WALL ST')][\"02-00-00\"],t1,t2)\n```\n\nshould output 1419 riders.","metadata":{"colab_type":"text","id":"QqgMHi0GPhVy"},"pos":47,"type":"cell"}
{"cell_type":"markdown","id":"1b1a5e","input":"4.How big is the data set?","metadata":{"colab_type":"text","id":"hpp8WuvNPhUm"},"pos":6,"type":"cell"}
{"cell_type":"markdown","id":"2a1cef","input":"2.What are the column names?","metadata":{"colab_type":"text","id":"ORJ0mTH0PhUe"},"pos":2,"type":"cell"}
{"cell_type":"markdown","id":"2bca8f","input":"3.We can see that there is a lot of whitespace at the end of the exits column name. Let's strip that whitespace:","metadata":{"colab_type":"text","id":"j5vI0VWzPhUj"},"pos":4,"type":"cell"}
{"cell_type":"markdown","id":"3d5443","input":"11.Create a dictionary called bigDict. It should contain a nested set of keys and values. The outermost key should be the tuple (C/A,UNIT,STATION) and its value should itself be a dictionary with the SCP as the key and a list of (TIME, EXITS) tuples as its values. The purpose of this section is to prepare data for later uses. It should take a little while to finish running.","metadata":{"colab_type":"text","id":"Nn50RQAgPhU_"},"pos":20,"type":"cell"}
{"cell_type":"markdown","id":"3ecf60","input":"7.What data types are each of the columns?","metadata":{"colab_type":"text","id":"5SJoHrr4PhUx"},"pos":12,"type":"cell"}
{"cell_type":"markdown","id":"445b11","input":"21.Delete these two keys from bigDict manually:","metadata":{"colab_type":"text","id":"3AKy82ddPhVo"},"pos":41,"type":"cell"}
{"cell_type":"markdown","id":"4cc672","input":"10.If we wanted to only look at the 34st Street Penn Station stop on 6/12/2017, what would we type?","metadata":{"colab_type":"text","id":"LZT4y83fPhU8"},"pos":18,"type":"cell"}
{"cell_type":"markdown","id":"4ea4e2","input":"30.Create a commuter index to be the average weekday exits divided by the sum of the avg weekday exits + avg weekend exits. To do this, first make a function called isWeekday that returns True if the datetime input is a weekday and False if it isn't.","metadata":{"colab_type":"text","id":"CtbpBxyRPhWE"},"pos":59,"type":"cell"}
{"cell_type":"markdown","id":"54f90f","input":"## Overall Cleaning Process\n19.This next cell does all of the previous cleanup in one cell. Run the cell below:","metadata":{"colab_type":"text","id":"A4YofuN7PhVh"},"pos":37,"type":"cell"}
{"cell_type":"markdown","id":"56074a","input":"# --At this point, the data is ready to use and so we are ready for data analysis.--\n23.Let's read the cleaned data file back in and save it as bigDict.","metadata":{"colab_type":"text","id":"KQeRQaOtPhVw"},"pos":45,"type":"cell"}
{"cell_type":"markdown","id":"61511c","input":"33.Remember that there are still several station areas within each station. Let's get all of the commuter indexes for each station area and then take the median of that commuter index to assign to the entire station. Create a sorted list of tuples in descending order containing the median commuter index and the station name.","metadata":{"colab_type":"text","id":"NsOCaBkdPhWP"},"pos":65,"type":"cell"}
{"cell_type":"markdown","id":"629df2","input":"29.Make a histogram of those station totals:","metadata":{"colab_type":"text","id":"kB0JnTbePhWB"},"pos":57,"type":"cell"}
{"cell_type":"markdown","id":"63850e","input":"27.Sort by busiest station areas during 6/12 midnight - 6/13 midnight in descending order by creating a list of sorted tuples:","metadata":{"colab_type":"text","id":"OQK29674PhV7"},"pos":53,"type":"cell"}
{"cell_type":"markdown","id":"790c4f","input":"#### Mistake Type I: Monotone but Decreasing - To fix this, we reflect the data. \n\n16.Run the cell below to fix it:","metadata":{"colab_type":"text","id":"yYQ1t9ELPhVS"},"pos":31,"type":"cell"}
{"cell_type":"markdown","id":"7b420c","input":"9.What is the earliest and latest date in our dataset?","metadata":{"colab_type":"text","id":"_aYeYy02PhU6"},"pos":16,"type":"cell"}
{"cell_type":"markdown","id":"8720b4","input":"15.Using the troublesome dictionary and your inspection plotting function, plot all of the troublesome data. There are several different types of errors. What do you think is causing each type?","metadata":{"colab_type":"text","id":"5ABIdqxlPhVL"},"pos":28,"type":"cell"}
{"cell_type":"markdown","id":"98a708","input":"## Finding Data Errors\n14.Due to bugs in MTA data, we will need to remove \"incorrect\" data. First, find the incorrect data by figuring out which turnstile counters aren't going strictly upwards. How many of these incorrect data values are there? Create a smaller dictionary callled \"trouble\" that contains the troublesome data from the bigDict.","metadata":{"colab_type":"text","id":"4PvO-TRJPhVI"},"pos":26,"type":"cell"}
{"cell_type":"markdown","id":"9eb558","input":"### How can you use what you have done so far to make decisions about MTA advertising???","metadata":{"colab_type":"text","id":"BrUye94NPhWT"},"pos":67,"type":"cell"}
{"cell_type":"markdown","id":"a2fe3b","input":"32.Create a sorted list of tuples in descending order containing the commuter index and the station area tuple.","metadata":{"colab_type":"text","id":"UQ80WNkhPhWK"},"pos":63,"type":"cell"}
{"cell_type":"markdown","id":"aca0ce","input":"28.Make a dictionary called total_dict that contains the station name as its key and the total number of riders through all of its station areas between 6/12-6/13 as its value. Then create a sorted list of tuples to view the busiest stations on that day.","metadata":{"colab_type":"text","id":"VDOq0JHPPhV_"},"pos":55,"type":"cell"}
{"cell_type":"markdown","id":"b153b5","input":"12.As an example, use the bigDict to view all of the turnstile data located at the('A037', 'R170', '14 ST-UNION SQ') area:","metadata":{"colab_type":"text","id":"qt7jRerOPhVC"},"pos":22,"type":"cell"}
{"cell_type":"markdown","id":"b41d40","input":"5.How many unique stations are there? What are they? Answer each of these questions in one line each.","metadata":{"colab_type":"text","id":"Cs09G8y-PhUp"},"pos":8,"type":"cell"}
{"cell_type":"markdown","id":"bbd393","input":"## Preliminary analysis\n\nThis notebook analyzes the MTA subway data for the week of June 10-17, 2017 that can be found here:\n\nhttp://web.mta.info/developers/turnstile.html\n\n1.Download that SAME file and read it in below. View the first few rows.","metadata":{"colab_type":"text","id":"mStpGvEbPhUa"},"pos":0,"type":"cell"}
{"cell_type":"markdown","id":"bebdfc","input":"#### Mistake Type III: Turnstile Reset - To fix this, shift the data upwards.\n\n18.Run the cell below to fix it:","metadata":{"colab_type":"text","id":"mwwLsrOlPhVd"},"pos":35,"type":"cell"}
{"cell_type":"markdown","id":"c9a00a","input":"6.Okay, so we understand what station represents. But what the heck are C/A, UNIT, and SCP? Keep in mind that in the larger stations, you might have multiple areas within one station that look like this:\n\n<img src=\"image.jpg\" style=\"width: 300px;\"/>\n\nFurther complicating things, there are a few station names like 14TH ST that refer to more than one station location along that street.\n\nThis data set is not very well documented. Welcome to the joys of real world data science!!!\n\nRead the following two links carefully to see other people's confusion and what information they have been able to gather:\n\nhttps://groups.google.com/forum/#!topic/mtadeveloperresources/AMVx2WUY9iI\n\nhttps://groups.google.com/forum/#!searchin/mtadeveloperresources/%22remote$20unit%22%7Csort:relevance/mtadeveloperresources/z8l3ZU9cY6Y/OFlHGkFAimQJ\n\nIt sounds like each C/A + UNIT + SCP + STATION combo refers to a single turnstile. How many unique turnstiles are there? ","metadata":{"colab_type":"text","id":"cHoomcKyPhUu"},"pos":10,"type":"cell"}
{"cell_type":"markdown","id":"dc8964","input":"#### Mistake Type II: Garbage Value - To fix this, remove the garbage value\n\n17.Run the cell below to fix it:","metadata":{"colab_type":"text","id":"rtUwUo-cPhVa"},"pos":33,"type":"cell"}
{"cell_type":"markdown","id":"e7d4cd","input":"8.We can see that the exits and entries are treated as integers but the others are all treated as objects (strings). Overwrite the time column so that it is a datetime object containing the combined date and time column info (so that the times have a chronological order). ","metadata":{"colab_type":"text","id":"gIc54DxNPhU2"},"pos":14,"type":"cell"}
{"cell_type":"markdown","id":"edbab1","input":"31.Make a function called commuterIndex that inputs a (C/A,UNIT,STATION) tuple and outputs its commuter index. \n\nFor example, the output of \n```python\ngetCommuteIndex(('PTH11', 'R545', '14TH STREET'))\n```\nshould be 0.663.","metadata":{"colab_type":"text","id":"z-07SD3SPhWG"},"pos":61,"type":"cell"}
{"cell_type":"markdown","id":"f2f315","input":"25.Create a function called stationRiders that calls the turnstileRiders function for each turnstile in a  (C/A,UNIT,STATION) station area and tallies all of the riders through that area between two times.\n\nFor example, an input of \n```python\ngetStationRangeRider(bigDict[('R204', 'R043', 'WALL ST')],dt(2017,6,12,0,0,0),dt(2017,6,13,0,0,0))\n```\nshould output 9507 riders.","metadata":{"colab_type":"text","id":"E25eeOU3PhV2"},"pos":49,"type":"cell"}
{"cell_type":"markdown","id":"fcbaed","input":"26.There are still several station areas within a station. Make a plot of the day of the week versus the number of total station rider exits for the ENTIRE Wall St station.","metadata":{"colab_type":"text","id":"Q-rMHLJOPhV5"},"pos":51,"type":"cell"}
{"id":0,"time":1555437497398,"type":"user"}
{"last_load":1555437498764,"type":"file"}